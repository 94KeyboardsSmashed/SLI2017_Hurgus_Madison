<!DOCTYPE html>
<html>
  <head>
    <title>Pi sensor real-time plots</title>
    <script type="text/javascript" src="vendor/smoothie.js"></script>
    <script type="text/javascript" src="vendor/reconnecting-websocket.min.js"></script>
    <script type="text/javascript">
      var indus = new TimeSeries();
      var yangtze = new TimeSeries();
      
      function createTimeline() {
        var chart = new SmoothieChart({
          interpolation:'bezier',
          minValue:-20.0,
          maxValue:20.0
        });
        chart.addTimeSeries(indus, { 
            strokeStyle: 'rgba(255, 255, 0, 0.6)',
            fillStyle: 'rgba(0, 0, 255, 0.2)',
            lineWidth: 3 });

        chart.addTimeSeries(yangtze, { 
            strokeStyle: 'rgba(255, 255, 157, 0.6)',
            fillStyle: 'rgba(128, 255, 128, 0.2)',
            lineWidth: 3 });

        chart.streamTo(document.getElementById("chart"), 500);
      }
      var ws = new ReconnectingWebSocket('ws://temeraire:8080/');
      ws.onopen = function() {
        document.body.style.backgroundColor = '#cfc';
      };
      ws.onclose = function() {
        document.body.style.backgroundColor = null;
      };
      ws.onmessage = function(event) {
        var data = event.data.split(",");
        var timestamp = parseFloat(data[0]) * 1000;  // expects ms
        var z_indus_value = parseFloat(data[3]);
        var z_yangtze_value = parseFloat(data[8])
        indus.append(timestamp, z_indus_value);
        yangtze.append(timestamp, z_yangtze_value);
      };
    </script>
  </head>
  <body onload="createTimeline()">
    <h2>Real Time Accelerometer Plots</h2>
    <p>Real time accelerometer data output in the form of raw z accelerometer readings in m/s<sup>2</sup></p>
    <p>The whiter colored line is damped with a liquid. The darker line is undamped.
       Shake and find out if it is sucessful at damping liquids!</p>
    <canvas id="chart" width="800" height="400"></canvas>
  </body>
</html>