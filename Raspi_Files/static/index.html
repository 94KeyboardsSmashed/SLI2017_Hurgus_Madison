<!DOCTYPE html>
<html>
  <head>
    <title>Pi Accelerometer Real-Time Plots</title>
    <script type="text/javascript" src="vendor/smoothie.js"></script>
    <script type="text/javascript" src="vendor/reconnecting-websocket.min.js"></script>
    <script type="text/javascript">

      var readingMag = new TimeSeries();

      function createTimeline() {
        var chart = new SmoothieChart({
          interpolation:'bezier',
          minValue:-20,
          maxValue:20
        });

      chart.addTimeSeries(readingMag, {
          strokeStyle: '#00ff00',
          fillStyle: 'rgba(64,128,128,0.5)',
          lineWidth: 3 });
          chart.streamTo(document.getElementById("chart"), 500);
      }

      var ws = new ReconnectingWebSocket('ws://172.20.10.4:8080/'); 
      ws.onopen = function() {
        document.body.style.backgroundColor = '#cfc';
      };
      ws.onclose = function() {
        document.body.style.backgroundColor = null;
      };
      ws.onmessage = function(event) {
        var data = event.data.split(",");
        var timestamp = new Date().getTime() 
        var valueX = parseFloat(data[1]);
	      var valueY = parseFloat(data[2]);
	      var valueZ = parseFloat(data[3]);
        var valueMag = parseFloat(data[4])
	
        readingMag.append(timestamp, valueMag);
      };

    </script>
  </head>
  <body onload="createTimeline()">
    <canvas id="chart" width="800" height="400"></canvas>
  </body>
</html>
